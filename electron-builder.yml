appId: com.mailvalet.app
productName: Mail Valet
directories:
  output: release
  buildResources: build
artifactName: "mailvalet-${version}-${os}-${arch}.${ext}"
portable:
  artifactName: "mailvalet-${version}-${os}-${arch}-portable.${ext}"
  buildUniversalInstaller: false
publish:
  provider: github
  owner: kakehashi-inc
  repo: https://github.com/kakehashi-inc/mail_valet
  releaseType: release
releaseInfo:
  releaseName: "v${version}"
  releaseNotes: |
    ## New Features

    - Show progress dialog with per-target message count during bulk/period delete (all modes)
    - Unify body-part download logic between sampling and rule-mode delete

    ## Bug Fixes

    - IMAP: Remove inappropriate fallback that fetched all emails when date-range sampling returned 0 results
    - IMAP: Fix deadlock in rule-mode bulk delete caused by nested FETCH/DOWNLOAD commands
    - Fix stale rule groups persisting when sampling returns 0 results
    - Fix rule groups not rebuilding when switching fetch mode (days/range)
    - Fix race condition causing empty rule groups when switching accounts in rule mode
    - Fix stale from/subject groups persisting after fetch returns 0 results or fails

files:
  - dist/**/*
  - public/**/*
  - "!**/*.ts"
  - "!**/*.tsx"
  - "!**/*.map"
  - "!**/node_modules/*/{CHANGELOG.md,README.md,README,readme.md,readme}"
  - "!**/node_modules/*/{test,__tests__,tests,powered-test,example,examples}"
  - "!**/node_modules/*.d.ts"
  - "!**/node_modules/.bin"

win:
  icon: public/icon.ico
  executableName: mailvalet
  target:
    - target: nsis
      arch:
        - x64
        - arm64
    - target: portable
      arch:
        - x64
        - arm64

nsis:
  shortcutName: Mail Valet
  buildUniversalInstaller: false
  oneClick: false
  perMachine: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
  createStartMenuShortcut: true
  deleteAppDataOnUninstall: true

mac:
  category: public.app-category.developer-tools
  icon: public/icon.png
  hardenedRuntime: true
  gatekeeperAssess: false
  notarize: true
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  target:
    - target: dmg
      arch:
        - x64
        - arm64

linux:
  icon: public/icon.png
  category: Development
  target:
    - target: AppImage
      arch:
        - x64
        - arm64
    - target: deb
      arch:
        - x64
        - arm64
    - target: rpm
      arch:
        - x64
        - arm64
  desktop:
    entry:
      Name: Mail Valet
      Comment: "Mail Valet."
      Categories: Development;
